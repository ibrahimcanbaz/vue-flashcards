<!DOCTYPE html>
<html>

<head>
  <title>FlashCards</title>
  <script src="https://unpkg.com/vue"></script>
  <link rel="stylesheet" type="text/css" href="style.css" />
  <!-- template for the component -->
</head>

<body>
  <article id="app" class="flashcard">
    <input id="flashcard-1" type="checkbox" />
    <label for="flashcard-1">
      <section class="front">
        <div class="refresh">
          {{jsonfile.length}} - {{visibleCount}}
        </div>
        <div class="fontText">
          {{front}}
        </div>
        <div class="buttons">
          <img v-on:click="setIKnow()" width="50em" src="checked.svg" />
        </div>
      </section>
      <section v-on:click="refresh()" class="back">
        {{back}}
      </section>
    </label>
  </article>

  <script>
    let vue = new Vue({
      el: "#app",
      data: {
        front: "You loaded this page but now words loaded ",
        back: "sorry",
        jsonfile: [],
        index: 0,
        visibleCount:0,
      },
      beforeMount: function () {
        let wordAray = [];
        if (localStorage.getItem("@list")) {
          this.jsonfile = JSON.parse(localStorage.getItem("@list"));
          this.randomlySetWord();
          return;
        }
        //confirm("Do you want to reset yo ur list ?");

        fetch("words.json")
          .then(r => r.json())
          .then(
            json => {
              Object.keys(json).forEach(x => {
                wordAray.push({ uk: x, en: json[x] });
              });
              this.jsonfile = wordAray;
              localStorage.setItem("@list", JSON.stringify(this.jsonfile));
              this.randomlySetWord();
            },
            response => {
              console.log("Error loading json:", response);
            }
          );
      },
      methods: {
        getRandom: (min, max) => {
          return Math.floor(Math.random() * (max - min + 1)) + min;
        },
        refresh: function () {
          this.randomlySetWord();
        },
        setIKnow: function () {
          this.jsonfile.splice(this.index, 1);
          localStorage.setItem("@list", JSON.stringify(this.jsonfile));
          this.refresh();
        },
        randomlySetWord(){
          let id = this.getRandom(0, this.jsonfile.length);
          this.front = this.jsonfile[id]["uk"];
          this.back = this.jsonfile[id]["en"];
          this.index = id;
          this.visibleCount = this.jsonfile[id]["vc"]? this.jsonfile[id]["vc"] = this.jsonfile[id]["vc"]+1 : this.jsonfile[id]["vc"] = 1 ;
          this.jsonfile[id]["vc"]
        }
      }
    });
      // vue.getJson();
  </script>
</body>

</html>
